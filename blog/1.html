<!doctype html>
<html>
<head>
    
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>Truly Anonymous Exfiltration Through ZCash, IPFS copy</title><link href='https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext' rel='stylesheet' type='text/css' /><style type='text/css'>html {overflow-x: initial !important;}:root { --bg-color: #ffffff; --text-color: #333333; --select-text-bg-color: #B5D6FC; --select-text-font-color: auto; --monospace: "Lucida Console",Consolas,"Courier",monospace; }
html { font-size: 14px; background-color: var(--bg-color); color: var(--text-color); font-family: "Helvetica Neue", Helvetica, Arial, sans-serif; -webkit-font-smoothing: antialiased; }
body { margin: 0px; padding: 0px; height: auto; bottom: 0px; top: 0px; left: 0px; right: 0px; font-size: 1rem; line-height: 1.42857143; overflow-x: hidden; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; tab-size: 4; background-position: inherit inherit; background-repeat: inherit inherit; }
iframe { margin: auto; }
a.url { word-break: break-all; }
a:active, a:hover { outline: 0px; }
.in-text-selection, ::selection { text-shadow: none; background: var(--select-text-bg-color); color: var(--select-text-font-color); }
#write { margin: 0px auto; height: auto; width: inherit; word-break: normal; word-wrap: break-word; position: relative; white-space: normal; overflow-x: visible; padding-top: 40px; }
#write.first-line-indent p { text-indent: 2em; }
#write.first-line-indent li p, #write.first-line-indent p * { text-indent: 0px; }
#write.first-line-indent li { margin-left: 2em; }
.for-image #write { padding-left: 8px; padding-right: 8px; }
body.typora-export { padding-left: 30px; padding-right: 30px; }
.typora-export .footnote-line, .typora-export li, .typora-export p { white-space: pre-wrap; }
@media screen and (max-width: 500px) { 
  body.typora-export { padding-left: 0px; padding-right: 0px; }
  #write { padding-left: 20px; padding-right: 20px; }
  .CodeMirror-sizer { margin-left: 0px !important; }
  .CodeMirror-gutters { display: none !important; }
}
#write li > figure:last-child { margin-bottom: 0.5rem; }
#write ol, #write ul { position: relative; }
img { max-width: 100%; vertical-align: middle; }
button, input, select, textarea { color: inherit; font-family: inherit; font-size: inherit; font-style: inherit; font-variant-caps: inherit; font-weight: inherit; font-stretch: inherit; line-height: inherit; }
input[type="checkbox"], input[type="radio"] { line-height: normal; padding: 0px; }
*, ::after, ::before { box-sizing: border-box; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p, #write pre { width: inherit; }
#write h1, #write h2, #write h3, #write h4, #write h5, #write h6, #write p { position: relative; }
p { line-height: inherit; }
h1, h2, h3, h4, h5, h6 { break-after: avoid-page; break-inside: avoid; orphans: 2; }
p { orphans: 4; }
h1 { font-size: 2rem; }
h2 { font-size: 1.8rem; }
h3 { font-size: 1.6rem; }
h4 { font-size: 1.4rem; }
h5 { font-size: 1.2rem; }
h6 { font-size: 1rem; }
.md-math-block, .md-rawblock, h1, h2, h3, h4, h5, h6, p { margin-top: 1rem; margin-bottom: 1rem; }
.hidden { display: none; }
.md-blockmeta { color: rgb(204, 204, 204); font-weight: 700; font-style: italic; }
a { cursor: pointer; }
sup.md-footnote { padding: 2px 4px; background-color: rgba(238, 238, 238, 0.701961); color: rgb(85, 85, 85); border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-right-radius: 4px; border-bottom-left-radius: 4px; cursor: pointer; }
sup.md-footnote a, sup.md-footnote a:hover { color: inherit; text-transform: inherit; text-decoration: inherit; }
#write input[type="checkbox"] { cursor: pointer; width: inherit; height: inherit; }
figure { overflow-x: auto; margin: 1.2em 0px; max-width: calc(100% + 16px); padding: 0px; }
figure > table { margin: 0px !important; }
tr { break-inside: avoid; break-after: auto; }
thead { display: table-header-group; }
table { border-collapse: collapse; border-spacing: 0px; width: 100%; overflow: auto; break-inside: auto; text-align: left; }
table.md-table td { min-width: 32px; }
.CodeMirror-gutters { border-right-width: 0px; background-color: inherit; }
.CodeMirror-linenumber { }
.CodeMirror { text-align: left; }
.CodeMirror-placeholder { opacity: 0.3; }
.CodeMirror pre { padding: 0px 4px; }
.CodeMirror-lines { padding: 0px; }
div.hr:focus { cursor: none; }
#write pre { white-space: pre-wrap; }
#write.fences-no-line-wrapping pre { white-space: pre; }
#write pre.ty-contain-cm { white-space: normal; }
.CodeMirror-gutters { margin-right: 4px; }
.md-fences { font-size: 0.9rem; display: block; break-inside: avoid; text-align: left; overflow: visible; white-space: pre; background-image: inherit; background-size: inherit; background-attachment: inherit; background-origin: inherit; background-clip: inherit; background-color: inherit; position: relative !important; background-position: inherit inherit; background-repeat: inherit inherit; }
.md-diagram-panel { width: 100%; margin-top: 10px; text-align: center; padding-top: 0px; padding-bottom: 8px; overflow-x: auto; }
#write .md-fences.mock-cm { white-space: pre-wrap; }
.md-fences.md-fences-with-lineno { padding-left: 0px; }
#write.fences-no-line-wrapping .md-fences.mock-cm { white-space: pre; overflow-x: auto; }
.md-fences.mock-cm.md-fences-with-lineno { padding-left: 8px; }
.CodeMirror-line, twitterwidget { break-inside: avoid; }
.footnotes { opacity: 0.8; font-size: 0.9rem; margin-top: 1em; margin-bottom: 1em; }
.footnotes + .footnotes { margin-top: 0px; }
.md-reset { margin: 0px; padding: 0px; border: 0px; outline: 0px; vertical-align: top; text-decoration: none; text-shadow: none; float: none; position: static; width: auto; height: auto; white-space: nowrap; cursor: inherit; line-height: normal; font-weight: 400; text-align: left; box-sizing: content-box; direction: ltr; background-position: 0px 0px; background-repeat: initial initial; }
li div { padding-top: 0px; }
blockquote { margin: 1rem 0px; }
li .mathjax-block, li p { margin: 0.5rem 0px; }
li { margin: 0px; position: relative; }
blockquote > :last-child { margin-bottom: 0px; }
blockquote > :first-child, li > :first-child { margin-top: 0px; }
.footnotes-area { color: rgb(136, 136, 136); margin-top: 0.714rem; padding-bottom: 0.143rem; white-space: normal; }
#write .footnote-line { white-space: pre-wrap; }
@media print { 
  body, html { border: 1px solid transparent; height: 99%; break-after: avoid; break-before: avoid; }
  #write { margin-top: 0px; padding-top: 0px; border-color: transparent !important; }
  .typora-export * { -webkit-print-color-adjust: exact; }
  html.blink-to-pdf { font-size: 13px; }
  .typora-export #write { padding-left: 32px; padding-right: 32px; padding-bottom: 0px; break-after: avoid; }
  .typora-export #write::after { height: 0px; }
}
.footnote-line { margin-top: 0.714em; font-size: 0.7em; }
a img, img a { cursor: pointer; }
pre.md-meta-block { font-size: 0.8rem; min-height: 0.8rem; white-space: pre-wrap; background-color: rgb(204, 204, 204); display: block; overflow-x: hidden; background-position: initial initial; background-repeat: initial initial; }
p > .md-image:only-child:not(.md-img-error) img, p > img:only-child { display: block; margin: auto; }
p > .md-image:only-child { display: inline-block; width: 100%; }
#write .MathJax_Display { margin: 0.8em 0px 0px; }
.md-math-block { width: 100%; }
.md-math-block:not(:empty)::after { display: none; }
[contenteditable="true"]:active, [contenteditable="true"]:focus, [contenteditable="false"]:active, [contenteditable="false"]:focus { outline: 0px; box-shadow: none; }
.md-task-list-item { position: relative; list-style-type: none; }
.task-list-item.md-task-list-item { padding-left: 0px; }
.md-task-list-item > input { position: absolute; top: 0px; left: 0px; margin-left: -1.2em; margin-top: calc(1em - 10px); border: none; }
.math { font-size: 1rem; }
.md-toc { min-height: 3.58rem; position: relative; font-size: 0.9rem; border-top-left-radius: 10px; border-top-right-radius: 10px; border-bottom-right-radius: 10px; border-bottom-left-radius: 10px; }
.md-toc-content { position: relative; margin-left: 0px; }
.md-toc-content::after, .md-toc::after { display: none; }
.md-toc-item { display: block; color: rgb(65, 131, 196); }
.md-toc-item a { text-decoration: none; }
.md-toc-inner:hover { text-decoration: underline; }
.md-toc-inner { display: inline-block; cursor: pointer; }
.md-toc-h1 .md-toc-inner { margin-left: 0px; font-weight: 700; }
.md-toc-h2 .md-toc-inner { margin-left: 2em; }
.md-toc-h3 .md-toc-inner { margin-left: 4em; }
.md-toc-h4 .md-toc-inner { margin-left: 6em; }
.md-toc-h5 .md-toc-inner { margin-left: 8em; }
.md-toc-h6 .md-toc-inner { margin-left: 10em; }
@media screen and (max-width: 48em) { 
  .md-toc-h3 .md-toc-inner { margin-left: 3.5em; }
  .md-toc-h4 .md-toc-inner { margin-left: 5em; }
  .md-toc-h5 .md-toc-inner { margin-left: 6.5em; }
  .md-toc-h6 .md-toc-inner { margin-left: 8em; }
}
a.md-toc-inner { font-size: inherit; font-style: inherit; font-weight: inherit; line-height: inherit; }
.footnote-line a:not(.reversefootnote) { color: inherit; }
.md-attr { display: none; }
.md-fn-count::after { content: "."; }
code, pre, samp, tt { font-family: var(--monospace); }
kbd { margin: 0px 0.1em; padding: 0.1em 0.6em; font-size: 0.8em; color: rgb(36, 39, 41); background-color: rgb(255, 255, 255); border: 1px solid rgb(173, 179, 185); border-top-left-radius: 3px; border-top-right-radius: 3px; border-bottom-right-radius: 3px; border-bottom-left-radius: 3px; box-shadow: rgba(12, 13, 14, 0.2) 0px 1px 0px, rgb(255, 255, 255) 0px 0px 0px 2px inset; white-space: nowrap; vertical-align: middle; background-position: initial initial; background-repeat: initial initial; }
.md-comment { color: rgb(162, 127, 3); opacity: 0.8; font-family: var(--monospace); }
code { text-align: left; }
a.md-print-anchor { white-space: pre !important; border: none !important; display: inline-block !important; position: absolute !important; width: 1px !important; right: 0px !important; outline: 0px !important; text-shadow: initial !important; background-position: 0px 0px !important; background-repeat: initial initial !important; }
.md-inline-math .MathJax_SVG .noError { display: none !important; }
.html-for-mac .inline-math-svg .MathJax_SVG { vertical-align: 0.2px; }
.md-math-block .MathJax_SVG_Display { text-align: center; margin: 0px; position: relative; text-indent: 0px; max-width: none; max-height: none; min-height: 0px; min-width: 100%; width: auto; overflow-y: hidden; display: block !important; }
.MathJax_SVG_Display, .md-inline-math .MathJax_SVG_Display { width: auto; margin: inherit; display: inline-block !important; }
.MathJax_SVG .MJX-monospace { font-family: var(--monospace); }
.MathJax_SVG .MJX-sans-serif { font-family: sans-serif; }
.MathJax_SVG { display: inline; font-style: normal; font-weight: 400; line-height: normal; zoom: 90%; text-indent: 0px; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0px; min-height: 0px; border: 0px; padding: 0px; margin: 0px; }
.MathJax_SVG * { transition: none; }
.MathJax_SVG_Display svg { vertical-align: middle !important; margin-bottom: 0px !important; margin-top: 0px !important; }
.os-windows.monocolor-emoji .md-emoji { font-family: "Segoe UI Symbol", sans-serif; }
.md-diagram-panel > svg { max-width: 100%; }
[lang="flow"] svg, [lang="mermaid"] svg { max-width: 100%; height: auto; }
[lang="mermaid"] .node text { font-size: 1rem; }
table tr th { border-bottom-width: 0px; }
video { max-width: 100%; display: block; margin: 0px auto; }
iframe { max-width: 100%; width: 100%; border: none; }
.highlight td, .highlight tr { border: 0px; }
svg[id^="mermaidChart"] { line-height: 1em; }
mark { background-color: rgb(255, 255, 0); color: rgb(0, 0, 0); background-position: initial initial; background-repeat: initial initial; }
.md-html-inline .md-plain, .md-html-inline strong, mark .md-inline-math, mark strong { color: inherit; }
mark .md-meta { color: rgb(0, 0, 0); opacity: 0.3 !important; }


:root {
    --side-bar-bg-color: #fafafa;
    --control-text-color: #777;
}

@include-when-export url(https://fonts.loli.net/css?family=Open+Sans:400italic,700italic,700,400&subset=latin,latin-ext);

html {
    font-size: 16px;
}

body {
    font-family: "Open Sans","Clear Sans","Helvetica Neue",Helvetica,Arial,sans-serif;
    color: rgb(51, 51, 51);
    line-height: 1.6;
}

#write {
    max-width: 860px;
  	margin: 0 auto;
  	padding: 30px;
    padding-bottom: 100px;
}
#write > ul:first-child,
#write > ol:first-child{
    margin-top: 30px;
}

a {
    color: #4183C4;
}
h1,
h2,
h3,
h4,
h5,
h6 {
    position: relative;
    margin-top: 1rem;
    margin-bottom: 1rem;
    font-weight: bold;
    line-height: 1.4;
    cursor: text;
}
h1:hover a.anchor,
h2:hover a.anchor,
h3:hover a.anchor,
h4:hover a.anchor,
h5:hover a.anchor,
h6:hover a.anchor {
    text-decoration: none;
}
h1 tt,
h1 code {
    font-size: inherit;
}
h2 tt,
h2 code {
    font-size: inherit;
}
h3 tt,
h3 code {
    font-size: inherit;
}
h4 tt,
h4 code {
    font-size: inherit;
}
h5 tt,
h5 code {
    font-size: inherit;
}
h6 tt,
h6 code {
    font-size: inherit;
}
h1 {
    padding-bottom: .3em;
    font-size: 2.25em;
    line-height: 1.2;
    border-bottom: 1px solid #eee;
}
h2 {
   padding-bottom: .3em;
    font-size: 1.75em;
    line-height: 1.225;
    border-bottom: 1px solid #eee;
}
h3 {
    font-size: 1.5em;
    line-height: 1.43;
}
h4 {
    font-size: 1.25em;
}
h5 {
    font-size: 1em;
}
h6 {
   font-size: 1em;
    color: #777;
}
p,
blockquote,
ul,
ol,
dl,
table{
    margin: 0.8em 0;
}
li>ol,
li>ul {
    margin: 0 0;
}
hr {
    height: 2px;
    padding: 0;
    margin: 16px 0;
    background-color: #e7e7e7;
    border: 0 none;
    overflow: hidden;
    box-sizing: content-box;
}

li p.first {
    display: inline-block;
}
ul,
ol {
    padding-left: 30px;
}
ul:first-child,
ol:first-child {
    margin-top: 0;
}
ul:last-child,
ol:last-child {
    margin-bottom: 0;
}
blockquote {
    border-left: 4px solid #dfe2e5;
    padding: 0 15px;
    color: #777777;
}
blockquote blockquote {
    padding-right: 0;
}
table {
    padding: 0;
    word-break: initial;
}
table tr {
    border-top: 1px solid #dfe2e5;
    margin: 0;
    padding: 0;
}
table tr:nth-child(2n),
thead {
    background-color: #f8f8f8;
}
table tr th {
    font-weight: bold;
    border: 1px solid #dfe2e5;
    border-bottom: 0;
    margin: 0;
    padding: 6px 13px;
}
table tr td {
    border: 1px solid #dfe2e5;
    margin: 0;
    padding: 6px 13px;
}
table tr th:first-child,
table tr td:first-child {
    margin-top: 0;
}
table tr th:last-child,
table tr td:last-child {
    margin-bottom: 0;
}

.CodeMirror-lines {
    padding-left: 4px;
}

.code-tooltip {
    box-shadow: 0 1px 1px 0 rgba(0,28,36,.3);
    border-top: 1px solid #eef2f2;
}

.md-fences,
code,
tt {
    border: 1px solid #e7eaed;
    background-color: #f8f8f8;
    border-radius: 3px;
    padding: 0;
    padding: 2px 4px 0px 4px;
    font-size: 0.9em;
}

code {
    background-color: #f3f4f4;
    padding: 0 2px 0 2px;
}

.md-fences {
    margin-bottom: 15px;
    margin-top: 15px;
    padding-top: 8px;
    padding-bottom: 6px;
}


.md-task-list-item > input {
  margin-left: -1.3em;
}

@media print {
    html {
        font-size: 13px;
    }
    table,
    pre {
        page-break-inside: avoid;
    }
    pre {
        word-wrap: break-word;
    }
}

.md-fences {
	background-color: #f8f8f8;
}
#write pre.md-meta-block {
	padding: 1rem;
    font-size: 85%;
    line-height: 1.45;
    background-color: #f7f7f7;
    border: 0;
    border-radius: 3px;
    color: #777777;
    margin-top: 0 !important;
}

.mathjax-block>.code-tooltip {
	bottom: .375rem;
}

.md-mathjax-midline {
    background: #fafafa;
}

#write>h3.md-focus:before{
	left: -1.5625rem;
	top: .375rem;
}
#write>h4.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h5.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
#write>h6.md-focus:before{
	left: -1.5625rem;
	top: .285714286rem;
}
.md-image>.md-meta {
    /*border: 1px solid #ddd;*/
    border-radius: 3px;
    padding: 2px 0px 0px 4px;
    font-size: 0.9em;
    color: inherit;
}

.md-tag {
    color: #a7a7a7;
    opacity: 1;
}

.md-toc { 
    margin-top:20px;
    padding-bottom:20px;
}

.sidebar-tabs {
    border-bottom: none;
}

#typora-quick-open {
    border: 1px solid #ddd;
    background-color: #f8f8f8;
}

#typora-quick-open-item {
    background-color: #FAFAFA;
    border-color: #FEFEFE #e5e5e5 #e5e5e5 #eee;
    border-style: solid;
    border-width: 1px;
}

/** focus mode */
.on-focus-mode blockquote {
    border-left-color: rgba(85, 85, 85, 0.12);
}

header, .context-menu, .megamenu-content, footer{
    font-family: "Segoe UI", "Arial", sans-serif;
}

.file-node-content:hover .file-node-icon,
.file-node-content:hover .file-node-open-state{
    visibility: visible;
}

.mac-seamless-mode #typora-sidebar {
    background-color: #fafafa;
    background-color: var(--side-bar-bg-color);
}

.md-lang {
    color: #b4654d;
}

.html-for-mac .context-menu {
    --item-hover-bg-color: #E6F0FE;
}

#md-notification .btn {
    border: 0;
}

.dropdown-menu .divider {
    border-color: #e5e5e5;
}

.ty-preferences .window-content {
    background-color: #fafafa;
}

.ty-preferences .nav-group-item.active {
    color: white;
    background: #999;
}

 .typora-export li, .typora-export p, .typora-export,  .footnote-line {white-space: normal;} 
</style>
</head>
<body class='typora-export' >
<div  id='write'  class = 'is-mac'><h1><a name="untraceable-exfiltration-of-private-data-using-zcash-encrypted-memo-fields" class="md-header-anchor"></a><span>Untraceable Exfiltration of Private Data Using Zcash Encrypted Memo Fields</span></h1><blockquote><p><span>Author: AtropineTears</span></p><p><span>Date: 26 Apr. 2020</span></p></blockquote><p><span>If you would like to dive in further, here is the </span><a href='https://github.com/zcash/zips/blob/master/protocol/protocol.pdf'><span>Zcash Whitepaper</span></a><span>.</span></p><p><span>View current </span><a href='https://z.cash/upgrade/'><span>Zcash Network Information</span></a><span>.</span></p><p><span>Play around with </span><a href='https://zkwasm.kobi.one/'><span>zk-snarks in wasm</span></a><span>.</span></p><h2><a name="preface" class="md-header-anchor"></a><span>Preface</span></h2><p><strong><span>All of this is hypothetical and may not work correctly as described as of now due to technical problems in the process. Excuse my errors.</span></strong></p><p><span>This post will detail a novel method of exfiltration that is untraceable and does not rely on having to host content. The technique I am about to describe is exclusive to Zcash as far as I know and cannot be done on other blockchains, for reasons I will describe later.</span></p><p><span>To the best of my knowledge, a technique like this has not been described before.</span></p><p><span>This blog post may be incomplete as it is an old post and I have not reviewed it since it was written. Some information may be wrong. I am working on completing it.</span></p><h2><a name="playing-around-with-zcash-docker-container" class="md-header-anchor"></a><span>Playing Around With Zcash Docker Container</span></h2><p><span>If you have Docker and want to play around with the zcash daemon, you can pull the </span><a href='https://github.com/kost/docker-zcash'><span>Debian-Based Zcash Container</span></a><span> and run </span><strong><span>zcashd</span></strong><span> with the following:</span></p><p><code>docker run -it k0st/zcash zcashd</code></p><p><span>Alternatively, you can mine using this:</span></p><p><code>docker run -it k0st/zcash zcashd -gen</code></p><h2><a name="introduction" class="md-header-anchor"></a><span>Introduction</span></h2><p><span>Zcash is a cryptocurrency that promises financial privacy through implementing </span><strong><span>zk-SNARKs</span></strong><span>, a form of Zero-Knowledge Cryptography. zk-SNARKs are in themselves far from trivial to understand and I am still trying to wrap my head around all the steps. If you do want to learn about them, you can read the following resources which I found useful:</span></p><ul><li><a href='https://z.cash/technology/zksnarks/'><span>What are zk-SNARKs?</span></a></li><li><a href='https://medium.com/@VitalikButerin/zk-snarks-under-the-hood-b33151a013f6'><span>Zk-SNARKs: Under the Hood</span></a></li></ul><p><span>From a high-level, a zk-SNARK allows for the construction of a proof that is able to prove the validity of a statement / computation without revealing any further information aside from the validity of the statement, through the commitmemt of a witness. These proofs have interesting properties independent of the computation&#39;s complexity/size, like remaining </span><strong><span>constant in size</span></strong><span>, </span><strong><span>tiny in length</span></strong><span> (~288 bytes), and </span><strong><span>cheap to verify</span></strong><span> (~10ms). Furthermore, these proofs are </span><strong><span>Non-Interactive</span></strong><span> in that they only require the prover to generate the proof and do not require the verifier to choose the secret evaluation point(s) as in most Zero-Knowledge Cryptography.</span></p><p><strong><span>It is these zk-SNARKs that make this exfiltration technique possible.</span></strong><span> </span><a href='https://ethresear.ch/t/on-chain-scaling-to-potentially-500-tx-sec-through-mass-tx-validation/3477'><span>Vitalik Buterin himself has stated implementing zk-SNARKs could allow Ethereum to scale to 500tx/s from its current 15tx/s</span></a><span>.</span></p><h2><a name="understanding-zcash" class="md-header-anchor"></a><span>Understanding Zcash</span></h2><blockquote><p><span>If you already understand how Zcash works, feel free to skip this to get to the technique.</span></p></blockquote><p><span>Before I describe the technique, there are some parts of Zcash that you should be familiar with. You should have at least a basic understanding of what a Blockchain is which I don&#39;t doubt most do, and you should understand the concept of cryptocurrency mining.</span></p><h3><a name="addresses" class="md-header-anchor"></a><span>Addresses</span></h3><p><span>There are two types of addresses in Zcash, they are interoperable, and have the same transaction fees. They are as follows:</span></p><ul><li><strong><span>t</span></strong><span>-address</span></li><li><strong><span>z</span></strong><span>-address</span></li></ul><p><span>A </span><strong><span>t-address</span></strong><span> is a </span><strong><span>Transparent Address</span></strong><span>. It is exactly identical to how a Bitcoin Address works as Zcash uses the source code of Bitcoin for t-addresses. As its name suggests, its transparent and will not provide privacy.</span></p><p><span>A </span><strong><span>z-address</span></strong><span> is a </span><strong><span>Shielded Address</span></strong><span>. These are where the zk-SNARKs come into play and what will allow us to use the </span><strong><span>Encrypted Memo Fields</span></strong><span>. </span></p><p><span>These addresses are generated using zk-SNARKs and </span><strong><span>used to take ~40s and 2GB of RAM just to do the generation</span></strong><span>. The Sapling Upgrade which you can read about </span><a href='https://electriccoin.co/blog/reducing-shielded-proving-time-in-sapling/'><span>here</span></a><span> implements the elliptic curve BLS-12-381 and changes from SHA256 commitments to Pederson Commitments . These changes put the generation of a z-address only to only ~3s and only 40MB of RAM.</span></p><h3><a name="mining" class="md-header-anchor"></a><span>Mining</span></h3><p><span>Zcash uses </span><strong><span>Proof of Work</span></strong><span> to reach consensus on blocks, similar to Bitcoin. However, it differs from Bitcoin&#39;s PoW by using Equihash as opposed to Hashcat. Equihash is distinct from Hashcat by being memory-intensive and ASIC-Resistant. </span><strong><span>Mining plays an important role in the exfiltration technique I am going to describe</span></strong><span>, although there are still ways of using the technique without mining but it is an ugly solution.</span></p><p><span>GPU-mining is more efficient than CPU but both work fine for the technique. Its also 2019, the chances of solo mining a block are slim to none. In this case, you will need to use a mining pool.</span></p><p><strong><span>You do not need to download the whole blockchain to mine Zcash as far as I know</span></strong><span>. You can also see how much you will mine with a certain hash-rate </span><a href='https://whattomine.com/coins/166-zec-equihash'><span>here</span></a><span>.</span></p><p><span>If you would like to read more on setting up a miner for Zcash, please read the official documentation at the following: </span><a href='https://zcash.readthedocs.io/en/latest/rtd_pages/zcash_mining_guide.html'><span>Zcash-Mining-Guide</span></a></p><h3><a name="transaction-fee" class="md-header-anchor"></a><span>Transaction Fee</span></h3><p><span>The transaction fee for Zcash is set at a constant value of </span><strong><span>0.0001 ZEC</span></strong><span>. At the time of writing this, ZEC is worth about </span><span>$</span><span>40 </span><strong><span>making a single transaction around $0.0038</span></strong><span> or less than half a cent. It is because of zk-SNARKs that the transaction fee can remain so cheap.</span></p><h3><a name="encrypted-memo-field" class="md-header-anchor"></a><span>Encrypted Memo Field</span></h3><p><span>This is where all of this will come together. The encrypted memo field is only available to z-addresses and is used to attach data to transactions. </span><strong><span>A transaction from a z-address is always the same size (2,000 bytes) and will always include a 512 byte field in which you can attach arbitrary data to. Any bytes not filled up are padded with 0s to prevent others on the blockchain from differentiating between the sizes of shielded transactions.</span></strong></p><h3><a name="tor-support" class="md-header-anchor"></a><span>Tor Support</span></h3><p><span>Zcash also supports running Zcash as a Tor Hidden Service and to setup automatic listening on Tor. It also allows the setup of a Tor Hidden Zcash Server for a node.</span></p><h2><a name="the-exfiltration-technique-living-off-the-land-1" class="md-header-anchor"></a><span>The Exfiltration Technique: Living Off The Land (#1)</span></h2><p><span>Now the interesting part. The exfiltration technique itself, which I am sure most can already assume how it works. The reason I specified exfiltration of private keys is because a 4096-bit RSA Key can fit in a single Zcash Encrypted Field Memo. This technique can be done in a number of ways but I believe in self-sufficient systems and is why I find it best to mine on the infected host computer. You can also use it as an anonymous C2 for sending commands.</span></p><p><strong><span>Assumptions:</span></strong></p><ul><li><span>Red Teamers have remote access to the victims computer. They may potentially require to run as admin/root.</span></li><li><span>Victim is on Windows or Linux OS.</span></li><li><span>Windows Defender may detect some of the downloads (even ZEC wallets) as malicious and will require exclusions</span></li></ul><p><span>Here is the overview of it from the Red Teamers Side As Setup:</span></p><ol start='' ><li><strong><span>Create a Shielded Address</span></strong><span> (z-address) to use as your exfiltration address.</span></li><li><strong><span>Design a script or manually perform the specified actions</span></strong><span> on the victims computer.</span></li><li><span>(Optionally) Setup a Tor Zcash Node</span></li></ol><p><span>Here is the procedure for method one:</span></p><ol start='' ><li><span>On the victims computer, install Bminer or another ZEC mining software.</span></li><li><span>Setup a Z-Address on the victims computer to send the mined Zcash to.</span></li><li><span>Setup the address you would like to send information to and once mined, have it sent to that address. </span><em><span>This may require building the blockchain but there may be ways around this.</span></em></li></ol><h2><a name="the-better-exfiltration-technique-2" class="md-header-anchor"></a><span>The Better Exfiltration Technique (#2)</span></h2><p><span>This one is less hypothetical and more doable. It involves having access to another bot computer that already has the blockchain built and ZEC to make transactions. You do not need to mine ZEC in this instance. It is more suited for a linux operating system.</span></p><p><span>The system will need to be automated.</span></p><p><span>What will happen is data will be exfiltrated to this host that has the blockchain already built. The red teamer needs to automate a way of having the data sent. The red teamer should have a z-address already generated to send information to in the encrypted memo fields. </span></p><p><span>In this instance, the red teamer can exfiltrate data through a host that they use to make transactions on the blockchain using the encrypted memo field.</span></p><p><span>To sum it up, you need an infected computer that you can exfiltrate data to that can then make transactions on the blockchain. Because of the nature of the blockchain, the exfiltration technique is truly anonymous and untraceable but will require ZEC.</span></p><h3><a name="what-wallet-should-i-use" class="md-header-anchor"></a><span>What Wallet Should I Use</span></h3><p><span>Use the </span><a href='https://github.com/ZcashFoundation/zecwallet'><span>ZecWallet</span></a><span> and read the from docs </span><a href='https://docs.zecwallet.co/'><span>here</span></a><span>.</span></p><p><span>Alternatively, you can use the official </span><a href='https://z.cash/download/'><span>zcashd</span></a><span> CLI wallet but it requires Linux to operate. If needed, you may run a linux environment on the user&#39;s computer and potentially still use zcashd.</span></p><h3><a name="what-mining-pool-should-i-use" class="md-header-anchor"></a><span>What Mining Pool Should I Use</span></h3><p><a href='https://zcash.flypool.org/start'><span>Flypool</span></a><span> is the best and most popular mining pool for Zcash. The best part about it is that it supports anonymous mining, by using your deposit z-address as your username and by leaving your password blank. That&#39;s all.</span></p><h3><a name="what-mining-software-should-i-use" class="md-header-anchor"></a><span>What Mining Software Should I Use</span></h3><p><span>It looks like </span><a href='https://www.bminer.me/'><span>Bminer</span></a><span> is a good option for cross-platform (Windows/Linux) GPU Mining.</span></p><hr /><p><span>This wallet is chosen because it supports </span><strong><span>multiple platforms (Windows, Linux, MacOS)</span></strong><span> and also supports </span><strong><span>Shielded-Addresses / Memo Fields.</span></strong></p><p><span>You can pass the parameters at startup</span></p><p><code>--no-embedded</code></p><p><span>To force the wallet to connect to a remote node as opposed to using zcashd.</span></p><h2><a name="warnings-before-using" class="md-header-anchor"></a><span>Warnings Before Using</span></h2><p><span>Before using this technique, you should understand a few things.</span></p><ul><li><span>Only ~2.5% of ZEC are in z-addresses.</span></li><li><span>Windows Defender may mark some ZEC programs as malicious, so they require exclusions.</span></li><li><span>You may need to build the blockchain to send transactions.</span></li></ul><h1><a name="resources" class="md-header-anchor"></a><span>Resources</span></h1><p><span>Read about </span><a href='https://zcash.readthedocs.io/en/latest/rtd_pages/shielded_support.html'><span>Shielded Address Support in Zcash and supported Wallets</span></a></p><hr /><p><strong><span>Zero-Knowledge Proofs</span></strong><span> (ZKPs) are powerful, but often misunderstood. You should take a look at </span><a href='https://eprint.iacr.org/2018/046.pdf'><span>zk-STARKs</span></a><span>, which are still quite new but require no trusted setup, are Quantum-Resistant (uses hashing as opposed to discrete logs), and is able to scale. They address many of the problems that a</span></p><p><span>Some other ZKPs and related content that may interest you are:</span></p><ul><li><p><a href='https://eprint.iacr.org/2017/1066.pdf'><span>Bulletproofs</span></a></p><ul><li><span>Used by Monero with No Trusted Setup</span></li></ul></li><li><p><a href='https://eprint.iacr.org/2017/1132.pdf'><span>HyraxZK</span></a></p><ul><li><span>zk-SNARK with no trusted setup</span></li></ul></li><li><p><a href='https://eprint.iacr.org/2013/279.pdf'><span>Pinocchio</span></a></p></li><li><p><a href='https://github.com/gluk64/awesome-zero-knowledge-proofs'><span>List of ZKP Resources</span></a></p></li></ul><hr /><p><a href='/index.html/../'><span>Visit Homepage</span></a></p></div>
</body>
</html>